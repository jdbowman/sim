#
# Makefile for brigen
# L. Benkevitch Jan 16 2011
# Modified 15 Feb 2011 (thanks to Jeoffrey B. Crew)
#

CFLAGS = -g -Wall
CPPFLAGS = -I/usr/include/ -I../visgen/ -I../utilities/ -I${SIM_INC}
LDLIBS = -lcfitsio -lm

CC = gcc
YACC = bison
LEX = flex

#brigen: $(OBJECTS)  # I do not understand why it does not work?

brigen: brigen.o sources_to_image.o  image_to_fits.o read_prj.tab.o lex.yy.o
	$(CC) $(LDLIBS)  $(OBJECTS) -o brigen

%.o:	%.c read_prj.tab.c read_prj.tab.h lex.yy.c
	$(CC) $(CPPFLAGS) $(CFLAGS) -c $<

read_prj.tab.c read_prj.tab.h: read_prj.y
	$(YACC) -d read_prj.y

lex.yy.c: read_prj.l
	$(LEX) read_prj.l

install: brigen
	 mv brigen $(SIM_BIN)

clean:
	rm -f *.o lex.yy.c read_prj.tab.c read_prj.tab.h brigen

OBJECTS=\
	brigen.o  sources_to_image.o  image_to_fits.o\
	lex.yy.o  read_prj.tab.o
